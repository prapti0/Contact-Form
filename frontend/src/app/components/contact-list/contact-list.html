<!-- src/app/components/contact-list/contact-list.component.html -->

<div class="contact-list-container">
  <mat-card class="contact-list-card">

    <!-- ─── Card Header ─────────────────────────────────────────────── -->
    <mat-card-header>
      <mat-card-title>
        <mat-icon>contacts</mat-icon>&nbsp;Contact Directory
      </mat-card-title>
      <mat-card-subtitle>Manage your contact information</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>

      <!-- ─── Search & Refresh Toolbar ───────────────────────────────── -->
      <div class="toolbar">

        <!-- Search Field -->
        <mat-form-field appearance="outline" class="search-field">
          <mat-label>Search contacts</mat-label>
          <input
            matInput
            placeholder="Search by name, email, company..."
            (input)="onSearch($event.target?.value || '')"
            [value]="searchTerm"
          />
          <mat-icon matSuffix>search</mat-icon>
        </mat-form-field>

        <!-- Refresh Button -->
        <button
          mat-raised-button
          color="primary"
          (click)="refreshContacts()"
          class="refresh-button"
        >
          <mat-icon>refresh</mat-icon>&nbsp;Refresh
        </button>

      </div>

      <!-- ─── Loading Spinner ────────────────────────────────────────── -->
      <div *ngIf="isLoading" class="loading-container">
        <mat-spinner diameter="50"></mat-spinner>
        <p>Loading contacts...</p>
      </div>

      <!-- ─── Contacts Table ─────────────────────────────────────────── -->
      <div *ngIf="!isLoading" class="table-container">

        <table
          mat-table
          [dataSource]="dataSource"
          matSort
          (matSortChange)="onSortChange($event)"
          class="contacts-table"
        >

          <!-- Name -->
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
            <td mat-cell *matCellDef="let contact">
              <div class="contact-name">
                <mat-icon class="contact-icon">person</mat-icon>
                {{ contact.name }}
              </div>
            </td>
          </ng-container>

          <!-- Email -->
          <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Email</th>
            <td mat-cell *matCellDef="let contact">
              <a [href]="'mailto:' + contact.email" class="email-link">
                {{ contact.email }}
              </a>
            </td>
          </ng-container>

          <!-- Phone -->
          <ng-container matColumnDef="phoneNumber">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Phone</th>
            <td mat-cell *matCellDef="let contact">
              <a [href]="'tel:' + contact.phoneNumber" class="phone-link">
                {{ contact.phoneNumber }}
              </a>
            </td>
          </ng-container>

          <!-- Job Title -->
          <ng-container matColumnDef="jobTitle">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Job Title</th>
            <td mat-cell *matCellDef="let contact">
              {{ contact.jobTitle }}
            </td>
          </ng-container>

          <!-- Company -->
          <ng-container matColumnDef="company">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Company</th>
            <td mat-cell *matCellDef="let contact">
              <div class="company-cell">
                <mat-icon class="company-icon">business</mat-icon>
                {{ contact.company }}
              </div>
            </td>
          </ng-container>

          <!-- Created At -->
          <ng-container matColumnDef="createdAt">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Created</th>
            <td mat-cell *matCellDef="let contact">
              {{ formatDate(contact.createdAt) }}
            </td>
          </ng-container>

          <!-- Actions -->
          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef>Actions</th>
            <td mat-cell *matCellDef="let contact">
              <button
                mat-icon-button
                color="warn"
                (click)="deleteContact(contact)"
                matTooltip="Delete contact"
              >
                <mat-icon>delete</mat-icon>
              </button>
            </td>
          </ng-container>

          <!-- Table Rows -->
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="contact-row"></tr>

        </table>

        <!-- ─── No Data Message ──────────────────────────────────────── -->
        <div *ngIf="dataSource.data.length === 0" class="no-data">
          <mat-icon class="no-data-icon">inbox</mat-icon>
          <h3>No contacts found</h3>
          <p *ngIf="searchTerm">Try adjusting your search criteria.</p>
          <p *ngIf="!searchTerm">No contacts have been added yet.</p>
        </div>
      </div>

      <!-- ─── Paginator ──────────────────────────────────────────────── -->
      <mat-paginator
        [length]="totalElements"
        [pageSize]="pageSize"
        [pageIndex]="pageIndex"
        [pageSizeOptions]="[5, 10, 25, 50]"
        (page)="onPageChange($event)"
      >
      </mat-paginator>

    </mat-card-content>
  </mat-card>
</div>
